VERSION={{ file "/etc/default/keycloak-version" }}

KEYCLOAK_HOST="{{ keyOrDefault "keycloak/keycloak_host" "missing_keycloak_host" }}"

DB_ADDR="{{ keyOrDefault "keycloak/rds_host" "missing_rds_host" }}
DB_PORT="5432"
DB_DATABASE="keycloak"
{{ with secret "postgres-keycloak/creds/app" -}}
DB_USER="{{ .Data.username }}"
DB_PASSWORD="{{ .Data.password }}"
{{- end }}

{{ with secret "secret-keycloak/data/keycloak-secrets" -}}
KEYCLOAK_USER="{{ .Data.data.admin_username}}"
KEYCLOAK_PASSWORD="{{ .Data.data.admin_password }}"
{{- end -}}
