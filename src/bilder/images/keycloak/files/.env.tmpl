VERSION={{ file "/etc/default/keycloak-version" }}
KC_HOSTNAME="{{ keyOrDefault "keycloak/keycloak_host" "missing_keycloak_host" }}"
KC_PROXY="edge"

DB_ADDR="{{ keyOrDefault "keycloak/rds_host" "missing_rds_host" }}"
DB_PORT="5432"
DB_DATABASE="keycloak"
{{ with secret "postgres-keycloak/creds/app" -}}
DB_USER="{{ .Data.username }}"
DB_PASSWORD="{{ .Data.password }}"
{{- end }}

# Why are these ones 'KEYCLOAK_*' while the previous ones were 'KC_*'
{{ with secret "secret-keycloak/data/keycloak-secrets" -}}
KEYCLOAK_ADMIN="{{ .Data.data.admin_username}}"
KEYCLOAK_ADMIN_PASSWORD="{{ .Data.data.admin_password }}"
{{- end }}
