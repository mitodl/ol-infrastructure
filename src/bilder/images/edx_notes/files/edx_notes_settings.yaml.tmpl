# -*- mode: yaml -*-
{{ with $deployment := key "edx/deployment" }}
{{ with secret (printf "secret-%s/edx-notes" $deployment) }}
SECRET_KEY: {{ .Data.data.django_secret_key }}
# ID and Secret used for authenticating JWT Auth Tokens should match those
# configured for `edx-notes` Client in EdX's /admin/oauth2/client/
CLIENT_ID: {{ .Data.data.oauth_client_id }}
CLIENT_SECRET: {{ .Data.data.oauth_client_secret }}
{{ end }}
{{ with secret (printf "mariadb-%s/creds/notes" $deployment) }}
DATABASES:
  default:
    ENGINE: django.db.backends.mysql
    HOST: edxapp_db.service.consul
    NAME: edx_notes_api
    PASSWORD: {{ .Data.password }}
    PORT: 3306
    USER: {{ .Data.password }}
{{ end }}
{{ end }}

ALLOWED_HOSTS:
  - '*'

DEFAULT_HASHING_ALGORITHM: sha256

ELASTICSEARCH_URL:  https://{{ keyOrDefault "elasticsearch/host" "elasticsearch.service.consul" }}:443
ELASTICSEARCH_INDEX: edx_notes
